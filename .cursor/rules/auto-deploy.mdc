---
description: New articles need user approval. All other instructed changes (fixes, upgrades, layout, media) auto-deploy.
alwaysApply: true
---

# Deployment Workflow

This is a static website hosted on Vercel. Deploying is low risk.

## What Needs Approval: New Articles Only

New articles must be **built locally as drafts** for the user to review before deploying.

After completing a new article (text, charts, hero image):

1. **Build the site** so the article is viewable locally with all charts and images:
   ```bash
   cd hfn-build-system && python3 build.py
   ```
2. **Do NOT deploy.** The article is a draft until the user has read it and approved.
3. **Tell the user** the article is ready to review and where to find the built HTML (e.g. `hfn-site-output/articles/{slug}.html`).

Only after the user explicitly approves (e.g. "deploy", "ship it", "looks good"):

```bash
./scripts/deploy.sh "feat: description of changes"
```

## What Auto-Deploys: Everything Else the User Instructed

If the user has asked you to do something and it is **not a new article**, deploy it immediately without waiting for approval. This includes but is not limited to:

- **Fixes** — bug fixes, broken links, typos, chart corrections
- **Upgrades** — build system improvements, dependency updates, performance changes
- **Layout changes** — CSS, HTML structure, navigation, responsive design
- **Audio narrations** — generated for already-approved articles
- **Media assets** — chart images, thumbnails, hero image regeneration
- **Site-wide changes** — new features, styling updates, sharing improvements

The principle: the user's instruction **is** the approval. Don't ask twice.

## Deploy Commands

The deploy script handles build, commit, push, and Vercel deploy:

```bash
./scripts/deploy.sh "feat: description of changes"
```

### Manual steps (if not using the script):

1. Run the build: `cd hfn-build-system && python3 build.py`
2. Stage all changes: `git add .`
3. Commit with a descriptive message
4. Push to main: `git push origin main`
5. Deploy to Vercel: `cd hfn-site-output && vercel --prod --yes`

## Important

- The domain `www.historyfuturenow.com` is served by **Vercel**, not GitHub Pages
- `git push` alone does NOT deploy to the live site — you MUST run `vercel --prod`
- The deploy script handles both git push and Vercel deploy

## After Deploying

- Verify the site loads at https://www.historyfuturenow.com
- The deploy script auto-logs to `~/.memory/daily/YYYY-MM-DD.md`
